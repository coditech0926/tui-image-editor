!function t(e,n,i){function o(a,r){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return o(n?n:t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){tui.util.defineNamespace("tui.component.ImageEditor",t("./src/js/imageEditor"),!0)},{"./src/js/imageEditor":12}],2:[function(t,e,n){"use strict";var i=t("../interface/component"),o=t("../extension/cropzone"),s=t("../consts"),a=t("../util"),r=10,c=Math.abs,h=a.clamp,u=tui.util.defineClass(i,{init:function(t){this.setParent(t),this._cropzone=null,this._startX=null,this._startY=null,this._listeners={mousedown:$.proxy(this._onFabricMouseDown,this),mousemove:$.proxy(this._onFabricMouseMove,this),mouseup:$.proxy(this._onFabricMouseUp,this)}},name:s.componentNames.CROPPER,start:function(){var t;this._cropzone||(this._cropzone=new o({left:-10,top:-10,width:1,height:1,strokeWidth:0,cornerSize:10,cornerColor:"black",fill:"transparent",hasRotatingPoint:!1,hasBorders:!1,lockScalingFlip:!0,lockRotation:!0}),t=this.getCanvas(),t.deactivateAll(),t.add(this._cropzone),t.on("mouse:down",this._listeners.mousedown),t.defaultCursor="crosshair")},end:function(t){var e,n=this.getCanvas(),i=this._cropzone;return i?(n.selection=!0,n.defaultCursor="default",n.discardActiveObject(),n.off("mouse:down",this._listeners.mousedown),i.remove(),t&&(e=this._getCroppedImageData()),this._cropzone=null,e):null},_onFabricMouseDown:function(t){var e,n=this.getCanvas();t.target||(n.selection=!1,e=n.getPointer(t.e),this._startX=e.x,this._startY=e.y,n.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup}))},_onFabricMouseMove:function(t){var e=this.getCanvas(),n=e.getPointer(t.e),i=n.x,o=n.y,s=this._cropzone;c(i-this._startX)+c(o-this._startY)>r&&(s.remove(),s.set(this._calcRectDimensionFromPoint(i,o)),e.add(s))},_calcRectDimensionFromPoint:function(t,e){var n=this.getCanvas(),i=n.getWidth(),o=n.getHeight(),s=this._startX,a=this._startY,r=h(t,0,s),c=h(e,0,a);return{left:r,top:c,width:h(t,s,i)-r,height:h(e,a,o)-c}},_onFabricMouseUp:function(){var t=this._cropzone,e=this._listeners,n=this.getCanvas();n.setActiveObject(t),n.off({"mouse:move":e.mousemove,"mouse:up":e.mouseup})},_getCroppedImageData:function(){var t,e=this._cropzone;return e.isValid()?(t={left:e.getLeft(),top:e.getTop(),width:e.getWidth(),height:e.getHeight()},{imageName:this.getImageName(),url:this.getCanvas().toDataURL(t)}):null}});e.exports=u},{"../consts":8,"../extension/cropzone":9,"../interface/component":15,"../util":17}],3:[function(t,e,n){"use strict";var i=t("../interface/Component"),o=t("../consts"),s=tui.util.defineClass(i,{init:function(t){this.setParent(t)},name:o.componentNames.FLIP,getCurrentSetting:function(){var t=this.getCanvasImage();return{flipX:t.flipX,flipY:t.flipY}},set:function(t){var e,n=this.getCurrentSetting(),i=$.Deferred(),o=n.flipX!==!!t.flipX,s=n.flipY!==!!t.flipY;return o||s?(o&&(e=this._negateAngle()),s&&(e=this._negateAngle()),tui.util.extend(n,t),this.setImageProperties(n,!0),i.resolve(n,e)):i.reject()},_negateAngle:function(){var t=this.getCanvasImage(),e=parseFloat(-1*t.angle);return t.setAngle(e),e},reset:function(){return this.set({flipX:!1,flipY:!1})},flipX:function(){var t=this._negateAngle();return this.toggleImageProperties(["flipX"],!0),$.Deferred().resolve(this.getCurrentSetting(),t)},flipY:function(){var t=this._negateAngle();return this.toggleImageProperties(["flipY"],!0),$.Deferred().resolve(this.getCurrentSetting(),t)}});e.exports=s},{"../consts":8,"../interface/Component":13}],4:[function(t,e,n){"use strict";var i=t("../interface/Component"),o=t("../consts"),s=tui.util.defineClass(i,{init:function(t){this.setParent(t),this.width=12,this.color="rgba(0, 0, 0, 0.5)"},name:o.componentNames.FREE_DRAWING,start:function(t){var e=this.getCanvas();e.isDrawingMode=!0,this.setBrush(t)},setBrush:function(t){var e=this.getCanvas().freeDrawingBrush;t&&(this.width=t.width||this.width,this.color=t.color||this.color,e.width=this.width,e.color=this.color)},end:function(){var t=this.getCanvas();t.isDrawingMode=!1}});e.exports=s},{"../consts":8,"../interface/Component":13}],5:[function(t,e,n){"use strict";var i=t("../interface/component"),o=t("../consts"),s={padding:0,crossOrigin:"anonymous"},a=tui.util.defineClass(i,{init:function(t){this.setParent(t)},name:o.componentNames.IMAGE_LOADER,load:function(t,e){var n,i,o=this;return t||e?n=this._setBackgroundImage(e).done(function(e){o.setCanvasImage(t,e),o.adjustCanvasDimension()}):(i=this.getCanvas(),i.backgroundImage=null,i.renderAll(),n=$.Deferred(function(){o.setCanvasImage("",null)}).resolve()),n},_setBackgroundImage:function(t){var e,n=$.Deferred();return t?(e=this.getCanvas(),e.setBackgroundImage(t,function(){var t=e.backgroundImage;t.getElement()?n.resolve(t):n.reject()},s),n):n.reject()},_onSuccessImageLoad:function(t){var e=t.getBoundingRect(),n=e.width,i=e.height;this.setCanvasCssDimension({width:"100%",height:"","max-width":n+"px"}),this.setCanvasBackstoreDimension({width:n,height:i})}});e.exports=a},{"../consts":8,"../interface/component":15}],6:[function(t,e,n){"use strict";var i=t("../interface/component"),o=t("../consts"),s=1e3,a=700,r={cssOnly:!0},c={backstoreOnly:!0},h=tui.util.defineClass(i,{init:function(t){t=t||{},this.canvas=null,this.oImage=null,this.maxWidth=s||t.maxWidth,this.maxHeight=a||t.maxHeight,this.imageName=""},name:o.componentNames.MAIN,toDataURL:function(t){return this.canvas&&this.canvas.toDataURL(t)},setCanvasImage:function(t,e){tui.util.stamp(e),this.imageName=t,this.oImage=e},setCanvasElement:function(t){this.canvas=new fabric.Canvas($(t)[0],{containerClass:"tui-imageEditor-canvasContainer"})},adjustCanvasDimension:function(){var t=this.getCanvasImage().scale(1),e=t.getBoundingRect(),n=e.width,i=e.height,o=this.maxWidth/n,s=this.maxHeight/i,a=Math.min(n,this.maxWidth),r=Math.min(i,this.maxHeight);1>o&&s>o?(a=n*o,r=i*o):1>s&&o>s&&(a=n*s,r=i*s),this.setCanvasCssDimension({width:"100%",height:"","max-width":a+"px","max-height":r+"px"}),this.setCanvasBackstoreDimension({width:n,height:i}),this.getCanvas().centerObject(t)},setCanvasCssDimension:function(t){this.canvas.setDimensions(t,r)},setCanvasBackstoreDimension:function(t){this.canvas.setDimensions(t,c)},setImageProperties:function(t,e){var n=this.oImage;n&&(n.set(t).setCoords(),e&&this.canvas.renderAll())},toggleImageProperties:function(t,e){var n=this.oImage;n&&(n.toggle.apply(n,t),e&&this.canvas.renderAll())},getCanvasElement:function(){return this.canvas.getElement()},getCanvas:function(){return this.canvas},getCanvasImage:function(){return this.oImage},getImageName:function(){return this.imageName}});e.exports=h},{"../consts":8,"../interface/component":15}],7:[function(t,e,n){"use strict";var i=t("../interface/Component"),o=t("../consts"),s=tui.util.defineClass(i,{init:function(t){this.setParent(t)},name:o.componentNames.ROTATION,getCurrentAngle:function(){return this.getCanvasImage().angle},setAngle:function(t){var e,n=this.getCurrentAngle()%360,i=$.Deferred(),o=this.getCanvas();return t%=360,t===n?i.reject():(e=this.getCanvasImage(),e.setAngle(t).setCoords(),o.getObjects().forEach(function(e){e.setAngle(t).setCoords()}),this.adjustCanvasDimension(),i.resolve(t))},rotate:function(t){var e=this.getCurrentAngle();return this.setAngle((e+t)%360)}});e.exports=s},{"../consts":8,"../interface/Component":13}],8:[function(t,e,n){"use strict";var i=t("./util");e.exports={componentNames:i.keyMirror("MAIN","IMAGE_LOADER","CROPPER","FLIP","ROTATION","FREE_DRAWING"),commandNames:i.keyMirror("CLEAR","LOAD_IMAGE","FLIP_IMAGE","ROTATE_IMAGE","ADD_OBJECT"),eventNames:{LOAD_IMAGE:"loadImage",CLEAR_OBJECTS:"clear",CLEAR_IMAGE:"clearImage",START_CROPPING:"startCropping",END_CROPPING:"endCropping",FLIP_IMAGE:"flipImage",ROTATE_IMAGE:"rotateImage",ADD_OBJECT:"addObject",REMOVE_OBJECT:"removeObject",EMPTY_REDO_STACK:"emptyRedoStack",EMPTY_UNDO_STACK:"emptyUndoStack",PUSH_UNDO_STACK:"pushUndoStack",PUSH_REDO_STACK:"pushRedoStack"},IS_SUPPORT_FILE_API:!!(window.File&&window.FileList&&window.FileReader)}},{"./util":17}],9:[function(t,e,n){"use strict";var i=t("../util").clamp,o="tl",s="tr",a="mt",r="ml",c="mr",h="mb",u="bl",l="br",g=fabric.util.createClass(fabric.Rect,{initialize:function(t){this.callSuper("initialize",t),this.on({moving:this._onMoving,scaling:this._onScaling})},_render:function(t){var e,n,i,o,s=7,a=7;this.callSuper("_render",t),e=this.flipX?-1:1,n=this.flipY?-1:1,i=e/this.scaleX,o=n/this.scaleY,t.scale(i,o),this._fillOuterRect(t,"rgba(0, 0, 0, 0.55)"),this._strokeBorder(t,"rgb(0, 0, 0)",s),this._strokeBorder(t,"rgb(255, 255, 255)",s,a),t.scale(1/i,1/o)},_fillOuterRect:function(t,e){var n=this._getCoordinates(t),i=n.x,o=n.y;t.save(),t.fillStyle=e,t.beginPath(),t.moveTo(i[0]-1,o[0]-1),t.lineTo(i[3]+1,o[0]-1),t.lineTo(i[3]+1,o[3]+1),t.lineTo(i[0]-1,o[3]-1),t.lineTo(i[0]-1,o[0]-1),t.closePath(),t.moveTo(i[1],o[1]),t.lineTo(i[1],o[2]),t.lineTo(i[2],o[2]),t.lineTo(i[2],o[1]),t.lineTo(i[1],o[1]),t.closePath(),t.fill(),t.restore()},_getCoordinates:function(t){var e=Math.ceil,n=this.getWidth(),i=this.getHeight(),o=n/2,s=i/2,a=this.getLeft(),r=this.getTop(),c=t.canvas;return{x:tui.util.map([-(o+a),-o,o,o+(c.width-a-n)],e),y:tui.util.map([-(s+r),-s,s,s+(c.height-r-i)],e)}},_strokeBorder:function(t,e,n,i){var o=this.getWidth()/2,s=this.getHeight()/2;t.save(),t.strokeStyle=e,t.setLineDash&&t.setLineDash([n,n]),i&&(t.lineDashOffset=i),t.beginPath(),t.moveTo(-o,-s),t.lineTo(o,-s),t.lineTo(o,s),t.lineTo(-o,s),t.lineTo(-o,-s),t.stroke(),t.restore()},_onMoving:function(){var t=this.canvas,e=this.getLeft(),n=this.getTop(),o=this.getWidth(),s=this.getHeight(),a=t.getWidth()-o,r=t.getHeight()-s;this.setLeft(i(e,0,a)),this.setTop(i(n,0,r))},_onScaling:function(t){var e=this.canvas.getPointer(t.e),n=this._calcScalingSizeFromPointer(e);this.scale(1).set(n)},_calcScalingSizeFromPointer:function(t){var e=t.x,n=t.y,i=this._calcTopLeftScalingSizeFromPointer(e,n),o=this._calcBottomRightScalingSizeFromPointer(e,n);return this._makeScalingSettings(i,o)},_calcTopLeftScalingSizeFromPointer:function(t,e){var n=this.getHeight()+this.top,o=this.getWidth()+this.left,s=i(e,0,n-1),a=i(t,0,o-1);return{top:s,left:a,width:o-a,height:n-s}},_calcBottomRightScalingSizeFromPointer:function(t,e){var n=this.canvas,o=n.width,s=n.height,a=this.left,r=this.top;return{width:i(t,a+1,o)-a,height:i(e,r+1,s)-r}},_makeScalingSettings:function(t,e){var n,i=t.width,g=t.height,f=e.height,m=e.width,p=t.left,d=t.top;switch(this.__corner){case o:n=t;break;case s:n={width:m,height:g,top:d};break;case u:n={width:i,height:f,left:p};break;case l:n=e;break;case r:n={width:i,left:p};break;case a:n={height:g,top:d};break;case c:n={width:m};break;case h:n={height:f}}return n},isValid:function(){return this.left>=0&&this.top>=0&&this.width>0&&this.height>0}});e.exports=g},{"../util":17}],10:[function(t,e,n){"use strict";function i(t){return tui.util.stamp(t),new h({execute:function(e){var n=e[m].getCanvas(),i=$.Deferred();return n.contains(t)?i.reject():(n.add(t),i.resolve(t)),i},undo:function(e){var n=e[m].getCanvas(),i=$.Deferred();return n.contains(t)?n.remove(t):i.reject(),i.resolve(t)}})}function o(t,e){return new h({execute:function(n){var i=n[p],o=i.getCanvas();return this.store={prevName:i.getImageName(),prevImage:i.getCanvasImage(),objects:o.getObjects().slice()},o.clear(),i.load(t,e)},undo:function(t){var e=t[p],n=e.getCanvas(),i=this.store;return n.clear(),n.add.apply(n,i.objects),e.load(i.prevName,i.prevImage)}})}function s(t){return new h({execute:function(e){var n=e[d];return this.store=n.getCurrentSetting(),n[t]()},undo:function(t){var e=t[d];return e.set(this.store)}})}function a(t,e){return new h({execute:function(n){var i=n[v];return this.store=i.getCurrentAngle(),i[t](e)},undo:function(t){var e=t[v];return e.setAngle(this.store)}})}function r(){return new h({execute:function(t){var e=t[m].getCanvas(),n=$.Deferred();return this.store=e.getObjects().slice(),this.store.length?(e.clear(),n.resolve()):n.reject(),n},undo:function(t){var e=t[m].getCanvas();e.add.apply(e,this.store)}})}function c(t,e){return e=Array.prototype.slice.call(arguments,1),f[t].apply(null,e)}var h=t("../interface/command"),u=t("../consts"),l=u.componentNames,g=u.commandNames,f={},m=l.MAIN,p=l.IMAGE_LOADER,d=l.FLIP,v=l.ROTATION;f[g.LOAD_IMAGE]=o,f[g.FLIP_IMAGE]=s,f[g.ROTATE_IMAGE]=a,f[g.CLEAR_OBJECTS]=r,f[g.ADD_OBJECT]=i,e.exports={create:c}},{"../consts":8,"../interface/command":14}],11:[function(t,e,n){"use strict";var i=t("../util").keyMirror,o=i("UN_IMPLEMENTATION","NO_COMPONENT_NAME"),s={UN_IMPLEMENTATION:"Should implement a method: ",NO_COMPONENT_NAME:"Should set a component name"},a={UN_IMPLEMENTATION:function(t){return s.UN_IMPLEMENTATION+t},NO_COMPONENT_NAME:function(){return s.NO_COMPONENT_NAME}};e.exports={types:tui.util.extend({},o),create:function(t){var e;return t=t.toLowerCase(),e=a[t],Array.prototype.shift.apply(arguments),e.apply(null,arguments)}}},{"../util":17}],12:[function(t,e,n){"use strict";var i=t("./invoker"),o=t("./factory/command"),s=t("./consts"),a=s.eventNames,r=s.commandNames,c=s.componentNames,h=tui.util.defineClass({init:function(t){this._invoker=new i,this._canvas=null,this._setCanvas(t),this._attachInvokerEvents(),this._attachCanvasEvents()},_attachInvokerEvents:function(){var t=a.PUSH_UNDO_STACK,e=a.PUSH_REDO_STACK,n=a.EMPTY_UNDO_STACK,i=a.EMPTY_REDO_STACK;this._invoker.on(t,$.proxy(this.fire,this,t)),this._invoker.on(e,$.proxy(this.fire,this,e)),this._invoker.on(n,$.proxy(this.fire,this,n)),this._invoker.on(i,$.proxy(this.fire,this,i))},_attachCanvasEvents:function(){this._canvas.on({"path:created":$.proxy(this._onPathCreated,this),"object:added":$.proxy(function(t){var e,n=t.target;tui.util.hasStamp(n)||(e=o.create(r.ADD_OBJECT,n),this.fire(a.ADD_OBJECT,n),this._invoker.pushUndoStack(e))},this),"object:removed":$.proxy(function(t){this.fire(a.REMOVE_OBJECT,t.target)},this)})},_onPathCreated:function(t){var e=t.path;e.set({rotatingPointOffset:30,borderColor:"red",transparentCorners:!1,cornerColor:"green",cornerSize:6})},_setCanvas:function(t){var e;e=this._getMainComponent(),e.setCanvasElement(t),this._canvas=e.getCanvas()},getEventNames:function(){return tui.util.extend({},a)},_getMainComponent:function(){return this._getComponent(c.MAIN)},_getComponent:function(t){return this._invoker.getComponent(t)},clear:function(){var t=o.create(r.CLEAR_OBJECTS),e=$.proxy(this.fire,this,a.CLEAR_OBJECTS);t.setExecuteCallback(e),this.execute(t)},endAll:function(){this.endFreeDrawing(),this.endCropping(),this.deactivateAll()},deactivateAll:function(){this._canvas.deactivateAll()},execute:function(t){this.endAll(),this._invoker.invoke(t)},undo:function(){this.endAll(),this._invoker.undo()},redo:function(){this.endAll(),this._invoker.redo()},loadImageFromFile:function(t){t&&this.loadImageFromURL(t.name,URL.createObjectURL(t))},loadImageFromURL:function(t,e){var n,i,s=this;t&&e&&(n=$.proxy(this._callbackAfterImageLoading,this),i=o.create(r.LOAD_IMAGE,t,e),i.setExecuteCallback(n).setUndoCallback(function(t){t?n(t):s.fire(a.CLEAR_IMAGE)}),this.execute(i))},_callbackAfterImageLoading:function(t){var e=this._getMainComponent(),n=$(e.getCanvasElement());this.fire(a.LOAD_IMAGE,{originalWidth:t.width,originalHeight:t.height,currentWidth:n.width(),currentHeight:n.height()})},startCropping:function(){var t=this._getComponent(c.CROPPER);this.endAll(),t.start(),this.fire(a.START_CROPPING)},endCropping:function(t){var e=this._getComponent(c.CROPPER),n=e.end(t);this.fire(a.END_CROPPING),n&&this.loadImageFromURL(n.imageName,n.url)},_flip:function(t){var e=$.proxy(this.fire,this,a.FLIP_IMAGE),n=o.create(r.FLIP_IMAGE,t);n.setExecuteCallback(e).setUndoCallback(e),this.execute(n)},flipX:function(){this._flip("flipX")},flipY:function(){this._flip("flipY")},resetFlip:function(){this._flip("reset")},_rotate:function(t,e){var n=$.proxy(this.fire,this,a.ROTATE_IMAGE),i=o.create(r.ROTATE_IMAGE,t,e);i.setExecuteCallback(n).setUndoCallback(n),this.execute(i)},rotate:function(t){this._rotate("rotate",t)},setAngle:function(t){this._rotate("setAngle",t)},startFreeDrawing:function(t){this.endAll(),this._getComponent(c.FREE_DRAWING).start(t)},setBrush:function(t){this._getComponent(c.FREE_DRAWING).setBrush(t)},endFreeDrawing:function(){this._getComponent(c.FREE_DRAWING).end()},toDataURL:function(t){return this._getMainComponent().toDataURL(t)},getImageName:function(){return this._getMainComponent().getImageName()},clearUndoStack:function(){this._invoker.clearUndoStack()},clearRedoStack:function(){this._invoker.clearRedoStack()}});tui.util.CustomEvents.mixin(h),e.exports=h},{"./consts":8,"./factory/command":10,"./invoker":16}],13:[function(t,e,n){"use strict";var i=tui.util.defineClass({init:function(){},setCanvasImage:function(t,e){this.getRoot().setCanvasImage(t,e)},getCanvasElement:function(){return this.getRoot().getCanvasElement()},getCanvas:function(){return this.getRoot().getCanvas()},getCanvasImage:function(){return this.getRoot().getCanvasImage()},getImageName:function(){return this.getRoot().getImageName()},getEditor:function(){return this.getRoot().getEditor()},getName:function(){return this.name},setImageProperties:function(t,e){this.getRoot().setImageProperties(t,e)},toggleImageProperties:function(t,e){this.getRoot().toggleImageProperties(t,e)},setCanvasCssDimension:function(t){this.getRoot().setCanvasCssDimension(t)},setCanvasBackstoreDimension:function(t){this.getRoot().setCanvasBackstoreDimension(t)},setParent:function(t){this._parent=t||null},adjustCanvasDimension:function(){this.getRoot().adjustCanvasDimension()},getParent:function(){return this._parent},getRoot:function(){for(var t=this.getParent(),e=this;t;)e=t,t=e.getParent();return e}});e.exports=i},{}],14:[function(t,e,n){"use strict";var i=t("../factory/errorMessage"),o=i.create,s=i.types,a=tui.util.defineClass({init:function(t){this.execute=t.execute,this.undo=t.undo,this.executeCallback=null,this.undoCallback=null},execute:function(){throw new Error(o(s.UN_IMPLEMENTATION,"execute"))},undo:function(){throw new Error(o(s.UN_IMPLEMENTATION,"undo"))},setExecuteCallback:function(t){return this.executeCallback=t,this},setUndoCallback:function(t){return this.undoCallback=t,this}});e.exports=a},{"../factory/errorMessage":11}],15:[function(t,e,n){arguments[4][13][0].apply(n,arguments)},{dup:13}],16:[function(t,e,n){"use strict";var i=t("./component/imageLoader"),o=t("./component/cropper"),s=t("./component/main"),a=t("./component/flip"),r=t("./component/rotation"),c=t("./component/freeDrawing"),h=t("./consts").eventNames,u=tui.util.defineClass({init:function(){this._customEvents=new tui.util.CustomEvents,this._undoStack=[],this._redoStack=[],this._componentMap={},this._isLocked=!1,this.lock=$.proxy(this.lock,this),this.unlock=$.proxy(this.unlock,this),this._createComponents()},_createComponents:function(){var t=new s;this._register(t),this._register(new i(t)),this._register(new o(t)),this._register(new a(t)),this._register(new r(t)),this._register(new c(t))},_register:function(t){this._componentMap[t.getName()]=t},_invokeExecution:function(t){var e=this;return $.when(this.lock,t.execute(this._componentMap)).done(function(){e.pushUndoStack(t)}).done(t.executeCallback).always(this.unlock)},_invokeUndo:function(t){var e=this;return $.when(this.lock,t.undo(this._componentMap)).done(function(){e.pushRedoStack(t)}).done(t.undoCallback).always(this.unlock)},_fire:function(){var t=this._customEvents;t.fire.apply(t,arguments)},on:function(){var t=this._customEvents;t.on.apply(t,arguments)},getComponent:function(t){return this._componentMap[t]},lock:function(){this._isLocked=!0},unlock:function(){this._isLocked=!1},invoke:function(t){return this._isLocked?$.Deferred.reject():this._invokeExecution(t).done($.proxy(this.clearRedoStack,this))},undo:function(){var t,e=this._undoStack.pop();return e&&this._isLocked&&(this.pushUndoStack(e,!0),e=null),e?(this.isEmptyUndoStack()&&this._fire(h.EMPTY_UNDO_STACK),t=this._invokeUndo(e)):t=$.Deferred().reject(),t},redo:function(){var t,e=this._redoStack.pop();return e&&this._isLocked&&(this.pushRedoStack(e,!0),e=null),e?(this.isEmptyRedoStack()&&this._fire(h.EMPTY_REDO_STACK),t=this._invokeExecution(e)):t=$.Deferred().reject(),t},pushUndoStack:function(t,e){this._undoStack.push(t),e||this._fire(h.PUSH_UNDO_STACK)},pushRedoStack:function(t,e){this._redoStack.push(t),e||this._fire(h.PUSH_REDO_STACK)},isEmptyRedoStack:function(){return 0===this._redoStack.length},isEmptyUndoStack:function(){return 0===this._undoStack.length},clearUndoStack:function(){this.isEmptyUndoStack()||(this._undoStack=[],this._fire(h.EMPTY_UNDO_STACK))},clearRedoStack:function(){this.isEmptyRedoStack()||(this._redoStack=[],this._fire(h.EMPTY_REDO_STACK))}});e.exports=u},{"./component/cropper":2,"./component/flip":3,"./component/freeDrawing":4,"./component/imageLoader":5,"./component/main":6,"./component/rotation":7,"./consts":8}],17:[function(t,e,n){"use strict";var i=Math.min,o=Math.max;e.exports={clamp:function(t,e,n){var s;return e>n&&(s=e,e=n,n=s),o(e,i(t,n))},keyMirror:function(){var t={};return tui.util.forEach(arguments,function(e){t[e]=e}),t}}},{}]},{},[1]);